{"ast":null,"code":"import _regeneratorRuntime from \"/home/marcos/Desktop/Karma/frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/marcos/Desktop/Karma/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/marcos/Desktop/Karma/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/marcos/Desktop/Karma/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/marcos/Desktop/Karma/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/marcos/Desktop/Karma/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/marcos/Desktop/Karma/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/marcos/Desktop/Karma/frontend/src/pages/newPost.tsx\";\nimport React from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { getAuthToken } from \"../components/with_auth/with_auth\";\nimport { setAuthToken } from \"../components/with_auth/with_auth\";\nexport var NewPostInternal =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NewPostInternal, _React$Component);\n\n  function NewPostInternal(props) {\n    var _this;\n\n    _classCallCheck(this, NewPostInternal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NewPostInternal).call(this, props));\n    _this.state = {\n      title: \"\",\n      question: \"\",\n      field: \"\",\n      error: null\n    };\n    return _this;\n  }\n\n  _createClass(NewPostInternal, [{\n    key: \"handleSubmit\",\n    value: function handleSubmit(e) {\n      e.preventDefault();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        className: \"inputs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        placeholder: \"Title\",\n        onKeyUp: function onKeyUp(e) {\n          return _this2._updateTitle(e.target.value);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }), React.createElement(\"textarea\", {\n        placeholder: \"type your question here..\",\n        onKeyUp: function onKeyUp(e) {\n          return _this2._updateQuestion(e.target.value);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }, \"Field: \"), React.createElement(\"select\", {\n        onChange: function onChange(e) {\n          return _this2.setState({\n            field: e.target.value\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"\",\n        selected: true,\n        disabled: true,\n        hidden: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, \"Choose here\"), React.createElement(\"option\", {\n        value: \"IT\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, \"IT\"), React.createElement(\"option\", {\n        value: \"Business\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, \"Business\")), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: function onClick() {\n          return _this2._handleSubmit();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }, \"Submit\")));\n    } // Update the state (email) on keyup\n\n  }, {\n    key: \"_updateTitle\",\n    value: function _updateTitle(title) {\n      this.setState({\n        title: title\n      });\n    } // Update the state (password) on keyup\n\n  }, {\n    key: \"_updateQuestion\",\n    value: function _updateQuestion(question) {\n      this.setState({\n        question: question\n      });\n    }\n  }, {\n    key: \"_handleSubmit\",\n    value: function _handleSubmit() {\n      var _this3 = this;\n\n      _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var token;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return getToken(_this3.state.title, _this3.state.question, _this3.state.field);\n\n              case 3:\n                token = _context.sent;\n\n                // Reset error\n                _this3.setState({\n                  error: null\n                }); // Save token in window object\n                //(window as any).__token = token;\n\n\n                setAuthToken(token); // Redirect to home page\n\n                _this3.props.history.push(\"/home\");\n\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](0);\n\n                _this3.setState({\n                  error: _context.t0.error\n                });\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 9]]);\n      }))();\n    }\n  }]);\n\n  return NewPostInternal;\n}(React.Component);\nexport var NewPost = withRouter(function (props) {\n  return React.createElement(NewPostInternal, Object.assign({}, props, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }));\n});\n\nfunction getToken(_x, _x2, _x3) {\n  return _getToken.apply(this, arguments);\n}\n\nfunction _getToken() {\n  _getToken = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(title, question, field) {\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            return _context3.abrupt(\"return\", new Promise(function (resolve, reject) {\n              _asyncToGenerator(\n              /*#__PURE__*/\n              _regeneratorRuntime.mark(function _callee2() {\n                var token, data, response, json;\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        token = getAuthToken();\n                        data = {\n                          title: title,\n                          question: question,\n                          field: field\n                        };\n\n                        if (!token) {\n                          _context2.next = 10;\n                          break;\n                        }\n\n                        _context2.next = 5;\n                        return fetch(\"/links\", {\n                          method: \"POST\",\n                          headers: {\n                            \"Content-Type\": \"application/json\",\n                            \"x-auth-token\": token\n                          },\n                          body: JSON.stringify(data)\n                        });\n\n                      case 5:\n                        response = _context2.sent;\n                        _context2.next = 8;\n                        return response.json();\n\n                      case 8:\n                        json = _context2.sent;\n\n                        if (response.status === 200) {\n                          resolve(json.token);\n                        } else {\n                          reject(json);\n                        }\n\n                      case 10:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2, this);\n              }))();\n            }));\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, this);\n  }));\n  return _getToken.apply(this, arguments);\n}","map":{"version":3,"sources":["/home/marcos/Desktop/Karma/frontend/src/pages/newPost.tsx"],"names":["React","withRouter","getAuthToken","setAuthToken","NewPostInternal","props","state","title","question","field","error","e","preventDefault","_updateTitle","target","value","_updateQuestion","setState","_handleSubmit","getToken","token","history","push","Component","NewPost","Promise","resolve","reject","data","fetch","method","headers","body","JSON","stringify","response","json","status"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport { withRouter } from \"react-router-dom\";\nimport * as H from 'history';\nimport { getAuthToken } from \"../components/with_auth/with_auth\";\nimport { setAuthToken } from \"../components/with_auth/with_auth\";\n\ninterface newPostProps {\n    history: H.History;\n}\n\ninterface User {\n    id: string;\n    name: string;\n    bio: string;\n    pic: string;\n}\n\ninterface newPostState {\n    title: string;\n    question: string;\n    field: string;\n    error: string | null;\n}\n\nexport class NewPostInternal extends React.Component<newPostProps, newPostState>{\n    public constructor(props: newPostProps){\n        super(props);\n        this.state = {\n            title: \"\",\n            question: \"\",\n            field: \"\",\n            error: null\n        };\n    }\n\n   \n\n    handleSubmit(e: any){\n        e.preventDefault();\n    }\n\n    public render() {\n        return (\n            <div className=\"inputs\">\n                <form>\n                    <input \n                        type=\"text\"\n                        placeholder=\"Title\" \n                        onKeyUp={(e) => this._updateTitle((e as any).target.value)}\n                    />\n                    <br/>\n                    <textarea\n                        placeholder=\"type your question here..\" \n                        onKeyUp={(e) => this._updateQuestion((e as any).target.value)}\n                    />\n                    <br/>\n                    <label>Field: </label>\n                    <select\n                        onChange={e => this.setState({ field: e.target.value})}\n                    >\n                        <option value=\"\" selected disabled hidden>Choose here</option>\n                        <option value=\"IT\">IT</option>\n                        <option value=\"Business\">Business</option>\n                    </select>\n\n                    <br/>\n                    <button onClick={() => this._handleSubmit()}>Submit</button>\n\n                </form>\n\n            </div>\n            \n        )\n    }\n    // Update the state (email) on keyup\n    private _updateTitle(title: string) {\n        this.setState({ title: title });\n    }\n    // Update the state (password) on keyup\n    private _updateQuestion(question: string) {\n        this.setState({ question: question });\n    }\n\n    private _handleSubmit(){\n        (async () => {\n            try {\n                const token = await getToken(this.state.title, this.state.question, this.state.field);\n                // Reset error\n                this.setState({ error: null });\n                // Save token in window object\n                //(window as any).__token = token;\n                setAuthToken(token);\n                // Redirect to home page\n                this.props.history.push(\"/home\");\n            } catch(err) {\n                this.setState({ error: err.error });\n            }\n        })();\n    }\n    \n}\n\nexport const NewPost = withRouter(props => <NewPostInternal {...props}/>);\n\nasync function getToken(title: string, question: string, field: string) {\n    return new Promise<string>(function (resolve, reject) {\n        (async () => {\n            const token = getAuthToken();\n            const data = {\n                title: title,\n                question: question,\n                field: field\n            };\n            if (token) {\n                const response = await fetch(\n                    \"/links\",\n                    {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            \"x-auth-token\": token\n                        },\n                        body: JSON.stringify(data)\n                    }\n                );\n                const json = await response.json();\n                if (response.status === 200) {\n                    resolve(json.token);\n                } else {\n                    reject(json);\n                }\n            }\n        })();\n    });\n}\n\n\n"]},"metadata":{},"sourceType":"module"}