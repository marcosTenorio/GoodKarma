{"ast":null,"code":"import _classCallCheck from \"/Users/Levys/Desktop/Goodkarma/GoodKarma/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/Levys/Desktop/Goodkarma/GoodKarma/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/Levys/Desktop/Goodkarma/GoodKarma/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/Levys/Desktop/Goodkarma/GoodKarma/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/Levys/Desktop/Goodkarma/GoodKarma/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/Levys/Desktop/Goodkarma/GoodKarma/frontend/src/components/with_auth/with_auth.tsx\";\nimport * as React from \"react\";\nimport { fromEvent } from \"rxjs\";\nvar key = \"__token\";\nvar win = window;\nexport var getAuthToken = function getAuthToken() {\n  var token = win[key] ? win[key] : null;\n  return token;\n};\nvar authTokenObservable = fromEvent(document, \"authTokenChange\");\n\nvar onAuthTokenChange = function onAuthTokenChange(cb) {\n  authTokenObservable.subscribe({\n    next: function next(val) {\n      cb(val.detail);\n    }\n  });\n};\n\nvar WithAuth =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(WithAuth, _React$Component);\n\n  function WithAuth(props) {\n    var _this;\n\n    _classCallCheck(this, WithAuth);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(WithAuth).call(this, props));\n    _this.state = {\n      authToken: getAuthToken()\n    };\n    onAuthTokenChange(function (value) {\n      return _this.setState({\n        authToken: value\n      });\n    });\n    return _this;\n  }\n\n  _createClass(WithAuth, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, this.props.cb({\n        authToken: this.state.authToken\n      }));\n    }\n  }]);\n\n  return WithAuth;\n}(React.Component);\n\nexport function withAuth(cb) {\n  return function () {\n    return React.createElement(WithAuth, {\n      cb: cb,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    });\n  };\n}\nexport var setAuthToken = function setAuthToken(token) {\n  win[key] = token;\n  var authTokenChangeEvent = new CustomEvent(\"authTokenChange\", {\n    detail: token\n  });\n  document.dispatchEvent(authTokenChangeEvent);\n};","map":{"version":3,"sources":["/Users/Levys/Desktop/Goodkarma/GoodKarma/frontend/src/components/with_auth/with_auth.tsx"],"names":["React","fromEvent","key","win","window","getAuthToken","token","authTokenObservable","document","onAuthTokenChange","cb","subscribe","next","val","detail","WithAuth","props","state","authToken","value","setState","Component","withAuth","setAuthToken","authTokenChangeEvent","CustomEvent","dispatchEvent"],"mappings":";;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,SAAT,QAA0B,MAA1B;AAEA,IAAMC,GAAG,GAAG,SAAZ;AACA,IAAMC,GAAG,GAAIC,MAAb;AAEA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;AAC9B,MAAMC,KAAoB,GAAGH,GAAG,CAACD,GAAD,CAAH,GAAWC,GAAG,CAACD,GAAD,CAAd,GAAsB,IAAnD;AACA,SAAOI,KAAP;AACH,CAHM;AAKP,IAAMC,mBAAmB,GAAGN,SAAS,CAA6BO,QAA7B,EAAuC,iBAAvC,CAArC;;AAEA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,EAAD,EAA4C;AAClEH,EAAAA,mBAAmB,CAACI,SAApB,CAA8B;AAC1BC,IAAAA,IAAI,EAAE,cAAAC,GAAG,EAAI;AACTH,MAAAA,EAAE,CAACG,GAAG,CAACC,MAAL,CAAF;AACH;AAHyB,GAA9B;AAKH,CAND;;IAgBMC,Q;;;;;AACF,oBAAmBC,KAAnB,EAAyC;AAAA;;AAAA;;AACrC,kFAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACTC,MAAAA,SAAS,EAAEb,YAAY;AADd,KAAb;AAGAI,IAAAA,iBAAiB,CAAC,UAAAU,KAAK;AAAA,aAAI,MAAKC,QAAL,CAAc;AAAEF,QAAAA,SAAS,EAAEC;AAAb,OAAd,CAAJ;AAAA,KAAN,CAAjB;AALqC;AAMxC;;;;6BACe;AACZ,aACI,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK,KAAKH,KAAL,CAAWN,EAAX,CAAc;AAAEQ,QAAAA,SAAS,EAAE,KAAKD,KAAL,CAAWC;AAAxB,OAAd,CADL,CADJ;AAKH;;;;EAdkBlB,KAAK,CAACqB,S;;AAqB7B,OAAO,SAASC,QAAT,CAAkBZ,EAAlB,EAAyD;AAC5D,SAAO;AAAA,WAAM,oBAAC,QAAD;AAAU,MAAA,EAAE,EAAEA,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAN;AAAA,GAAP;AACH;AAED,OAAO,IAAMa,YAAY,GAAG,SAAfA,YAAe,CAACjB,KAAD,EAA0B;AAClDH,EAAAA,GAAG,CAACD,GAAD,CAAH,GAAWI,KAAX;AACA,MAAMkB,oBAAoB,GAAG,IAAIC,WAAJ,CAAgB,iBAAhB,EAAmC;AAAEX,IAAAA,MAAM,EAAER;AAAV,GAAnC,CAA7B;AACAE,EAAAA,QAAQ,CAACkB,aAAT,CAAuBF,oBAAvB;AACH,CAJM","sourcesContent":["import * as React from \"react\";\nimport { fromEvent } from \"rxjs\";\n\nconst key = \"__token\";\nconst win = (window as any);\n\nexport const getAuthToken = () => {\n    const token: string | null = win[key] ? win[key] : null;\n    return token;\n}\n\nconst authTokenObservable = fromEvent<CustomEvent<string | null>>(document, \"authTokenChange\");\n\nconst onAuthTokenChange = (cb: (authToken: string | null) => void) => {\n    authTokenObservable.subscribe({\n        next: val => {\n            cb(val.detail);\n        }\n    });\n};\n\ninterface WithAuthProps {\n    cb: (props: AuthProps) => JSX.Element\n}\n\ninterface WithAuthState {\n    authToken: string | null;\n}\n\nclass WithAuth extends React.Component<WithAuthProps, WithAuthState> {\n    public constructor(props: WithAuthProps) {\n        super(props);\n        this.state = {\n            authToken: getAuthToken()\n        };\n        onAuthTokenChange(value => this.setState({ authToken: value }));\n    }\n    public render() {\n        return (\n            <React.Fragment>\n                {this.props.cb({ authToken: this.state.authToken })}\n            </React.Fragment>\n        );\n    }\n}\n\nexport interface AuthProps {\n    authToken: string | null;\n}\n\nexport function withAuth(cb: (props: AuthProps) => JSX.Element) {\n    return () => <WithAuth cb={cb} />;\n}\n\nexport const setAuthToken = (token: string | null) => {\n    win[key] = token;\n    const authTokenChangeEvent = new CustomEvent(\"authTokenChange\", { detail: token });\n    document.dispatchEvent(authTokenChangeEvent);\n};\n"]},"metadata":{},"sourceType":"module"}